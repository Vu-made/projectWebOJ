<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../static/profile_full.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='profile_full.css') }}">
    <!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> -->
</head>
<body>
    <div id="main">
        <div id="profile-container">
            <div id="avatar-container">
                <img src="./avatar" alt="" id="avatar">
                <h1> {{ full_name }} </h1>
                <label>{{ interest }}</label>
                <div id="btn-item">
                    <button class="btn-item"><a href="/create-exercise">T·∫°o b√†i t·∫≠p</a></button>
                    <button class="btn-item" onclick="logout()"> <a>ƒëƒÉng xu·∫•t</a></button>
                    <button class="btn-item" > <a href="/edit_profile">ch·ªânh s·ª≠a th√¥ng tin</a> </button>
                    <button class="btn-item" > <a href="/"> quay v·ªÅ trang ch·ªß</a></button>
                </div>
            </div>
            <div id="info-profile">
                <div>
                    <h2>Th√¥ng tin c√° nh√¢n </h2>
                </div>
                <div>
                    <h3>Email: {{ email }} </h3>
                    <h3>ƒê·ªãa ch·ªâ: {{address}} </h3>
                    <h3>Ng√†y sinh : {{ date }}</h3>
                    <h2>
                        M·ª•c ti√™u
                    </h2>
                </div>
                <h3>{{ target }}</h3>
            </div>
            <div id="post-container">
                <div id="nav-tab">
                    <div class="nav-tab-item active" onclick="switchTab('normal-post' , this )">‚úèÔ∏è b√†i vi·∫øt </div>
                    <div class="nav-tab-item" onclick="switchTab('exercise' , this )" >üìó b√†i t·∫≠p</div>
                    <div class="nav-tab-item" onclick="switchTab('contest' , this )">üî• cu·ªôc thi</div>
                </div>
                <div id="post-content">
                     <div class="post-content-item active" id="normal-post">
                         <div id="post-space">
                            <h2>T·∫°o b√†i vi·∫øt</h2>
                            <textarea name="content" id="write-content" placeholder="Vi·∫øt g√¨ ƒë√≥....."></textarea>
                            <button class="submit" onclick="send(this)">ƒëƒÉng</button>
                        </div>
                    </div>
                    <div class="post-content-item" id="exercise">
                        <div class="watch-space">
                            <h2>L·ªãch s·ª≠ n·ªôp b√†i
                                <select name="" id="search-exercise-with-topic">
                                    <option value="all">t·∫•t c·∫£</option>
                                    <option value="mang1chieu">M·∫£ng 1 chi·ªÅu</option>
                                    <option value="xaukytu">X√¢u k√Ω t·ª±</option>
                                    <option value="sohoc">S·ªë h·ªçc</option>
                                    <option value="dequy">ƒê·ªá quy - Quay lui</option>
                                    <option value="thamlam">Tham lam</option>
                                    <option value="nhiphan">T√¨m ki·∫øm nh·ªã ph√¢n</option>
                                    <option value="demphanphoi">ƒê·∫øm ph√¢n ph·ªëi</option>
                                    <option value="mang2chieu">M·∫£ng 2 chi·ªÅu</option>
                                    <option value="qhd">Quy ho·∫°ch ƒë·ªông</option>
                                    <option value="dothi">ƒê·ªì th·ªã</option>
                                    <option value="cay">C√¢y</option>
                                    <option value="dsu">DSU, Fenwick Tree</option>
                                    <option value="kythuatdacbiet">K·ªπ thu·∫≠t ƒë·∫∑c bi·ªát</option>
                                    <option value="luyentap">Luy·ªán t·∫≠p</option>
                                </select>
                            </h2>
                            <table border="1px">
                                <thead>
                                    <tr>
                                        <th>t√™n b√†i</th>
                                        <th>tr·∫°ng th√°i</th>
                                        <th>h√†nh ƒë·ªông</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {{ list_problem_submit | safe }}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="post-content-item" id="contest">
                        <h2>
                            V√¨ V≈© kh√¥ng ƒëc th√¥ng minh l·∫Øm<br>n√™n mong m·ªçi ng∆∞·ªùi th√¥ng c·∫£m<br>·∫•n n√∫t ·ªü b√™n d∆∞·ªõi ƒë·ªÉ ƒë·∫øn ch·ªó <br> T·∫°o cu·ªôc thi
                        </h2>
                        <button class="btn-item"><a href="/create-contest">T·∫°o cu·ªôc thi</a></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
function switchTab(id, e) {
    document.querySelectorAll('.nav-tab-item').forEach(element => {
        element.classList.remove("active");
    });
    document.querySelectorAll('.post-content-item').forEach(element => {
        element.classList.remove("active");
    });
    document.getElementById(id).classList.add("active");
    e.classList.add("active");
}


function send( btn ) 
{
    const content_post = document.getElementById("write-content").value ;
    const today = new Date();
    const day = String(today.getDate()).padStart(2, '0');        // Ng√†y
    const month = String(today.getMonth() + 1).padStart(2, '0'); // Th√°ng (getMonth() b·∫Øt ƒë·∫ßu t·ª´ 0)
    const year = today.getFullYear();                            // NƒÉm

    const ngayThangNam = `${year}-${month}-${day}`;
    btn.disabled = true;

    fetch('/api/post', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({"content" : content_post , "time_post" : ngayThangNam })
    })
    .then(res => res.json())
    .then(data => {
        alert('‚úÖ G·ª≠i th√†nh c√¥ng: ' + data.message);
        window.location.href = '/';
    })
    .catch(err => {
        console.error('‚ùå L·ªói khi g·ª≠i d·ªØ li·ªáu:', err);
        alert('‚ùå G·ª≠i th·∫•t b·∫°i!');
    });
}
</script>
<script>
    document.getElementById("search-exercise-with-topic").addEventListener("change", function() {
        const selectedTopic = this.value;
        if (selectedTopic === "all") {
            document.querySelectorAll(".topic").forEach(element => {
                element.style.display = "table-row"; // Hi·ªÉn th·ªã t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class topic
            });
            return;
        }
        document.querySelectorAll(".topic").forEach(element => {
            element.style.display = "none"; // ·∫®n t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ class topic
        });
        document.querySelectorAll(`.${selectedTopic}`).forEach(element => {
            element.style.display = "table-row"; // Hi·ªÉn th·ªã c√°c ph·∫ßn t·ª≠ c√≥ class topic t∆∞∆°ng ·ª©ng
        });
    });
</script>
<script>
function logout() {
    Swal.fire({
        title: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?',
        text: "B·∫°n s·∫Ω ph·∫£i ƒëƒÉng nh·∫≠p l·∫°i ƒë·ªÉ ti·∫øp t·ª•c.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'ƒêƒÉng xu·∫•t',
        cancelButtonText: 'H·ªßy',
        backdrop: false
    }).then((result) => {
        if (result.isConfirmed) {
            window.location.href = '/logout';
        }
    });
}
</script>
</html>